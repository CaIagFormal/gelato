<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br">
<head>
    <div th:replace="~{pv/script::header (title=${'Carrinho (Ticket: '+ticket.ticket+')'})}"></div>

    <!-- CSS -->
    <link href="/css/carrinho_cliente.css" rel="stylesheet">
    <!-- JS -->
    <script src="/js/cadastrados.js" defer></script>
    <script src="/js/carrinho.js" defer></script>
    <div th:replace="~{pv/script :: incluir_obs}"></div>
</head>
<body>
<!-- Navbars --->
<div class="sticky-top"><div th:replace="~{pv/navbar.html :: cliente (v_navbar=${m_navbar})}"></div></div>

<div class="container" th:if="${carrinho.size > 0}">
    <div class="mt-4" th:fragment="pv_ticket">
        <div class="row">
            <div class="col-4">
                <h4 th:text="${'Ticket: '+ticket.ticket}"></h4>
                <p class="m-0" th:text="${'Obtido às: '+#temporals.format(ticket.horario_fornecido, 'HH:mm, dd-MM-yyyy')}"></p>
                <p class="m-0">Atualmente: <b th:text="${ticket.status.toString()}"></b></p>
                <p th:unless="${ticket.status.toString()=='CARRINHO'}" class="m-0" th:text="${'Encaminhado às: '+#temporals.format(ticket.pagamento.horario_fornecido, 'HH:mm, dd-MM-yyyy')}"></p>
            </div>
            <div class="col">
                <div class="input-group mb-3">
                    <label class="input-group-text" for="horario_retirada">Horário de retirada</label>
                    <input type="datetime-local" class="form-control" th:value="${ticket.horario_retirada}" id="horario_retirada" name="horario_retirada">
                    <button th:if="${alterar_outros}" class="btn btn-secondary" id="btn-horario-retirada">Salvar</button>
                </div>
            </div>
            <p>Esse valor é único ao seu pedido e serve para apresentar ao vendedor na retirada, poderá vê-lo a qualquer etapa.</p>
        </div>
    </div>

    <div th:each="item_do_carrinho : ${carrinho}">
        <div th:replace="~{pv/produto.html :: pv_item_do_carrinho (v_compra=${item_do_carrinho}, v_removivel=${alterar_monetario})}"></div>
    </div>

    <h4 th:text="${'Total: R$'+total}"></h4>

    <div th:replace="~{pv/script.html :: pv_obs (v_tipo='${ticket}')}"></div>

    <button th:if="${ticket.status.toString()=='CARRINHO'}" class="btn btn-primary" id="btn-encaminhar-pedido">Encaminhar Pedido</button>
    <button th:if="${ticket.status.toString()=='ENCAMINHADO'}" class="btn btn-danger" id="btn-cancelar-pedido">Cancelar Pedido</button>
</div>

<div class="container" th:unless="${carrinho.size > 0}">
    <div th:replace="~{ :: pv_ticket}"></div>

    <h2>Seu carrinho está vazio!</h2>
    <h3><a href="/catalogo">Retorne para o catálogo</a> para continuar comprando.</h3>
</div>
</body>
</html>